{"ast":null,"code":"import _objectSpread from\"/home/fred/React/pokemons/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/home/fred/React/pokemons/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/home/fred/React/pokemons/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useHistory}from'react-router-dom';import formatType from'../helpers/FormatType';import PokemonService from'../services/PokemonService';import ReactTooltip from'react-tooltip';var PokemonForm=function PokemonForm(_ref){var pokemon=_ref.pokemon,isEditForm=_ref.isEditForm;var history=useHistory();var _useState=useState({picture:{value:pokemon.picture},name:{value:pokemon.name,isValid:true},hp:{value:pokemon.hp,isValid:true},cp:{value:pokemon.cp,isValid:true},types:{value:pokemon.types,isValid:true}}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var types=['Plante','Feu','Eau','Insecte','Normal','Electrik','Poison','Fée','Vol','Combat','Psy'];var hasType=function hasType(type){return form.types.value.includes(type);};var handleInputChange=function handleInputChange(e){var fieldName=e.target.name;var fieldValue=e.target.value;var newField=_defineProperty({},fieldName,{value:fieldValue});setForm(_objectSpread(_objectSpread({},form),newField));};var selectType=function selectType(type,e){var checked=e.target.checked;var newField;if(checked){//Si l'utilisateur coche un type, on l'ajoute a la liste des types du pokemon\nvar newTypes=form.types.value.concat([type]);newField={value:newTypes};}else{//si l'utilisateur décoche un type on le retire de la liste des types du pk\nvar _newTypes=form.types.value.filter(function(currentType){return currentType!==type;});newField={value:_newTypes};}setForm(_objectSpread(_objectSpread({},form),{types:newField}));};var handleSubmit=function handleSubmit(e){e.preventDefault();var isFormValid=validateForm();if(isFormValid){pokemon.picture=form.picture.value;pokemon.name=form.name.value;pokemon.hp=form.hp.value;pokemon.cp=form.cp.value;pokemon.types=form.types.value;isEditForm?updatePokemon():addpokemon();}};var addpokemon=function addpokemon(){PokemonService.addPokemon(pokemon).then(function(){return history.push('/pokemons');});};var updatePokemon=function updatePokemon(){PokemonService.updatePokemon(pokemon).then(function(){return history.push(\"/pokemons/\".concat(pokemon.id));});};var isAddForm=function isAddForm(){return!isEditForm;};var validateForm=function validateForm(){var newForm=form;//Validate url\nif(isAddForm()){var start=\"https://assets.pokemon.com/assets/cms2/img/pokedex/detail/\";var end=\".png\";if(!form.picture.value.startsWith(start)||!form.picture.value.endsWith(end)){var errorMsg=\"L'url n'est pas valide\";var newField={value:form.picture.value,error:errorMsg,isValid:false};newForm=_objectSpread(_objectSpread({},newForm),{picture:newField});}else{var _newField2={value:form.picture.value,error:'',isValid:true};newForm=_objectSpread(_objectSpread({},newForm),{picture:_newField2});}}//Validate Name\nif(!/^[a-zA-Zàéè ]{3,25}$/.test(form.name.value)){var _errorMsg='Le nom du pokémon est obligatoire (1 à 25 caractères pas de caractères, spéciaux).';var _newField3={value:form.name.value,error:_errorMsg,isValid:false};newForm=_objectSpread(_objectSpread({},newForm),{name:_newField3});}else{var _newField4={value:form.name.value,error:'',isValid:true};newForm=_objectSpread(_objectSpread({},newForm),{name:_newField4});}//validate hp\nif(!/^[0-9]{1,3}$/.test(form.hp.value)){var _errorMsg2='Les point de vie doivent être compris entre 0 et 999.';var _newField5={value:form.hp.value,error:_errorMsg2,isValid:false};newForm=_objectSpread(_objectSpread({},newForm),{hp:_newField5});}else{var _newField6={value:form.hp.value,error:'',isValid:true};newForm=_objectSpread(_objectSpread({},newForm),{hp:_newField6});}//validate cp\nif(!/^[0-9]{1,2}$/.test(form.cp.value)){var _errorMsg3='Les dégâts doivent être compris entre 0 et 99.';var _newField7={value:form.cp.value,error:_errorMsg3,isValid:false};newForm=_objectSpread(_objectSpread({},newForm),{cp:_newField7});}else{var _newField8={value:form.cp.value,error:'',isValid:true};newForm=_objectSpread(_objectSpread({},newForm),{cp:_newField8});}setForm(newForm);return newForm.name.isValid&&newForm.hp.isValid&&newForm.cp.isValid&&newForm.picture;};var isTypesValid=function isTypesValid(type){if(form.types.value.length===1&&hasType(type)){return false;}if(form.types.value.length>=3&&!hasType(type)){return false;}return true;};var deletePokemon=function deletePokemon(){PokemonService.deletePokemon(pokemon).then(function(){return history.push(\"/pokemons\");});};return/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){return handleSubmit(e);}},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col s12 m8 offset-m2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card hoverable\"},isEditForm&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-image\"},/*#__PURE__*/React.createElement(\"img\",{src:pokemon.picture,alt:pokemon.name,style:{width:'250px',margin:'0 auto'}}),/*#__PURE__*/React.createElement(\"span\",{className:\"btn-floating halfway-fab waves-effect waves-light red\"},/*#__PURE__*/React.createElement(\"i\",{onClick:deletePokemon,className:\"material-icons\"},\"delete\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"card-stacked\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-content\"},isAddForm()&&/*#__PURE__*/React.createElement(\"div\",{\"data-tip\":\"Remplacer: xxx par le num\\xE9ro du pokemon.\",className:\"form-group\"},/*#__PURE__*/React.createElement(ReactTooltip,{place:\"top\",type:\"error\",effect:\"float\"}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"name\"},\"Image\"),/*#__PURE__*/React.createElement(\"input\",{id:\"picture\",name:\"picture\",type:\"text\",className:\"form-control\",value:form.picture.value,onChange:function onChange(e){return handleInputChange(e);}}),form.picture.error&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-panel red accent-1\"},form.picture.error)),/*#__PURE__*/React.createElement(\"div\",{\"data-tip\":\"Remplacer les ... par un nom au choix, soyez cr\\xE9atif !\",className:\"form-group\"},/*#__PURE__*/React.createElement(ReactTooltip,{place:\"top\",type:\"error\",effect:\"float\"}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"name\"},\"Nom\"),/*#__PURE__*/React.createElement(\"input\",{id:\"name\",name:\"name\",type:\"text\",className:\"form-control\",value:form.name.value,onChange:function onChange(e){return handleInputChange(e);}}),form.name.error&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-panel red accent-1\"},form.name.error)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"hp\"},\"Point de vie\"),/*#__PURE__*/React.createElement(\"input\",{id:\"hp\",name:\"hp\",type:\"number\",className:\"form-control\",value:form.hp.value,onChange:function onChange(e){return handleInputChange(e);}}),form.hp.error&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-panel red accent-1\"},form.hp.error)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"cp\"},\"D\\xE9g\\xE2ts\"),/*#__PURE__*/React.createElement(\"input\",{id:\"cp\",name:\"cp\",type:\"number\",className:\"form-control\",value:form.cp.value,onChange:function onChange(e){return handleInputChange(e);}}),form.cp.error&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-panel red accent-1\"},form.cp.error)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Types\"),types.map(function(type){return/*#__PURE__*/React.createElement(\"div\",{key:type,style:{marginBottom:'10px'}},/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(\"input\",{id:type,type:\"checkbox\",className:\"filled-in\",value:type,disabled:!isTypesValid(type),checked:hasType(type),onChange:function onChange(e){return selectType(type,e);}}),/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(\"p\",{className:formatType(type)},type))));}))),/*#__PURE__*/React.createElement(\"div\",{className:\"card-action center\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn\"},\"Valider\")))))));};export default PokemonForm;","map":{"version":3,"sources":["/home/fred/React/pokemons/src/components/PokemonForm.tsx"],"names":["React","useState","useHistory","formatType","PokemonService","ReactTooltip","PokemonForm","pokemon","isEditForm","history","picture","value","name","isValid","hp","cp","types","form","setForm","hasType","type","includes","handleInputChange","e","fieldName","target","fieldValue","newField","selectType","checked","newTypes","concat","filter","currentType","handleSubmit","preventDefault","isFormValid","validateForm","updatePokemon","addpokemon","addPokemon","then","push","id","isAddForm","newForm","start","end","startsWith","endsWith","errorMsg","error","test","isTypesValid","length","deletePokemon","width","margin","map","marginBottom"],"mappings":"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","sourcesContent":["import React, { FunctionComponent, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Pokemon from '../models/pokemon';\nimport formatType from '../helpers/FormatType';\nimport PokemonService from '../services/PokemonService';\nimport ReactTooltip from 'react-tooltip'\n  \ntype Props = {\n  pokemon: Pokemon,\n  isEditForm: boolean\n};\n\ntype Field = {\n  value?: any,\n  error?: string,\n  isValid?: boolean\n}\n\ntype Form = {\n  picture: Field,\n  name: Field,\n  hp: Field,\n  cp: Field,\n  types: Field\n}\n  \nconst PokemonForm: FunctionComponent<Props> = ({pokemon, isEditForm}) => {\n\n  const history = useHistory()\n\n  const [form, setForm] = useState<Form>({\n    picture: { value: pokemon.picture },\n    name: { value: pokemon.name, isValid: true },\n    hp: { value: pokemon.hp, isValid: true },\n    cp: { value: pokemon.cp, isValid: true },\n    types: { value: pokemon.types, isValid: true },\n  })\n\n  \n  \n  const types: string[] = [\n    'Plante', 'Feu', 'Eau', 'Insecte', 'Normal', 'Electrik',\n    'Poison', 'Fée', 'Vol', 'Combat', 'Psy'\n  ];\n\n  const hasType = (type:string): boolean => {\n    return form.types.value.includes(type)\n  }\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const fieldName: string = e.target.name\n    const fieldValue: string = e.target.value\n    const newField: Field = {[fieldName]: { value: fieldValue }}\n\n    setForm({... form, ...newField})\n  }\n\n  const selectType = (type: string, e: React.ChangeEvent<HTMLInputElement>): void => {\n    const checked = e.target.checked\n    let newField: Field\n\n    if(checked) {\n      //Si l'utilisateur coche un type, on l'ajoute a la liste des types du pokemon\n      const newTypes: string[] = form.types.value.concat([type])\n      newField = { value: newTypes }\n    }else {\n      //si l'utilisateur décoche un type on le retire de la liste des types du pk\n      const newTypes: string[] = form.types.value.filter((currentType: string) => currentType !== type)\n      newField = { value: newTypes }\n    }\n\n    setForm({...form, ...{ types: newField }})\n  }\n\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault()\n    const isFormValid = validateForm()\n\n    if(isFormValid) {\n      pokemon.picture = form.picture.value\n      pokemon.name = form.name.value\n      pokemon.hp = form.hp.value\n      pokemon.cp = form.cp.value\n      pokemon.types = form.types.value\n\n      isEditForm ? updatePokemon() : addpokemon()\n      }\n  }\n\n  const addpokemon = () => {\n    PokemonService.addPokemon(pokemon).then(() => history.push('/pokemons'))\n  }\n\n  const updatePokemon = () => {\n    PokemonService.updatePokemon(pokemon).then(() => history.push(`/pokemons/${pokemon.id}`))\n  }\n\n  const isAddForm = (): boolean => {\n    return !isEditForm\n  }\n\n  const validateForm = () => {\n    let newForm: Form = form\n\n    //Validate url\n    if(isAddForm()) {\n      const start = \"https://assets.pokemon.com/assets/cms2/img/pokedex/detail/\"\n      const end = \".png\"\n\n      if(!form.picture.value.startsWith(start) || !form.picture.value.endsWith(end)) {\n        const errorMsg: string = \"L'url n'est pas valide\"\n        const newField: Field = { value: form.picture.value, error: errorMsg, isValid: false }\n        newForm = { ...newForm, ...{picture: newField} }\n      } else {\n        const newField: Field = { value: form.picture.value, error: '', isValid: true }\n        newForm = { ...newForm, ...{picture: newField} }\n      }\n    }\n\n    //Validate Name\n    if(!/^[a-zA-Zàéè ]{3,25}$/.test(form.name.value)) {\n      const errorMsg: string = 'Le nom du pokémon est obligatoire (1 à 25 caractères pas de caractères, spéciaux).'\n      const newField: Field = { value: form.name.value, error: errorMsg, isValid: false }\n      newForm = { ...newForm, ...{ name: newField }}\n    }else {\n      const newField: Field = { value: form.name.value, error: '', isValid: true }\n      newForm = { ...newForm, ...{ name: newField }}\n    }\n\n    //validate hp\n    if(!/^[0-9]{1,3}$/.test(form.hp.value)) {\n      const errorMsg: string = 'Les point de vie doivent être compris entre 0 et 999.'\n      const newField: Field = { value: form.hp.value, error: errorMsg, isValid: false }\n      newForm = { ...newForm, ...{ hp: newField }}\n    }else {\n      const newField: Field = { value: form.hp.value, error: '', isValid: true }\n      newForm = { ...newForm, ...{ hp: newField }}\n    }\n\n    //validate cp\n    if(!/^[0-9]{1,2}$/.test(form.cp.value)) {\n      const errorMsg: string = 'Les dégâts doivent être compris entre 0 et 99.'\n      const newField: Field = { value: form.cp.value, error: errorMsg, isValid: false }\n      newForm = { ...newForm, ...{ cp: newField }}\n    }else {\n      const newField: Field = { value: form.cp.value, error: '', isValid: true }\n      newForm = { ...newForm, ...{ cp: newField }}\n    }\n\n    setForm(newForm)\n    return newForm.name.isValid && newForm.hp.isValid && newForm.cp.isValid && newForm.picture\n  }\n\n  const isTypesValid = (type: string): boolean => {\n    if(form.types.value.length === 1 && hasType(type)) {\n      return false\n    }\n\n    if(form.types.value.length >= 3 && !hasType(type)) {\n      return false\n    }\n\n    return true\n  }\n\n  const deletePokemon = () => {\n    PokemonService.deletePokemon(pokemon).then(() => history.push(`/pokemons`))\n  }\n   \n  return (\n    <form onSubmit={e => handleSubmit(e)}>\n      <div className=\"row\">\n        <div className=\"col s12 m8 offset-m2\">\n          <div className=\"card hoverable\"> \n          {isEditForm && (\n            <div className=\"card-image\">\n              <img src={pokemon.picture} alt={pokemon.name} style={{width: '250px', margin: '0 auto'}}/>\n              <span className=\"btn-floating halfway-fab waves-effect waves-light red\">\n                <i onClick={deletePokemon} className=\"material-icons\">delete</i>\n              </span>\n            </div>\n            )}\n            <div className=\"card-stacked\">\n              <div className=\"card-content\">\n                {/* Pokemon picture */}\n                {isAddForm() && ( \n                  <div  data-tip=\"Remplacer: xxx par le numéro du pokemon.\" className=\"form-group\">\n                  <ReactTooltip place=\"top\" type=\"error\" effect=\"float\"/>\n                  <label htmlFor=\"name\">Image</label>\n                  <input id=\"picture\" name=\"picture\" type=\"text\" className=\"form-control\" value={form.picture.value} onChange={e => handleInputChange(e)}></input>\n                  {form.picture.error && \n                    <div className=\"card-panel red accent-1\">\n                      {form.picture.error}\n                    </div>\n                  }\n                </div>\n                )}\n                {/* Pokemon name */}\n                <div data-tip=\"Remplacer les ... par un nom au choix, soyez créatif !\" className=\"form-group\">\n                 <ReactTooltip place=\"top\" type=\"error\" effect=\"float\"/>\n                  <label htmlFor=\"name\">Nom</label>\n                  <input id=\"name\" name=\"name\" type=\"text\" className=\"form-control\" value={form.name.value} onChange={e => handleInputChange(e)}></input>\n                  {form.name.error && \n                    <div className=\"card-panel red accent-1\">\n                      {form.name.error}\n                    </div>\n                  }\n                </div>\n                {/* Pokemon hp */}\n                <div className=\"form-group\">\n                  <label htmlFor=\"hp\">Point de vie</label>\n                  <input id=\"hp\" name=\"hp\" type=\"number\" className=\"form-control\" value={form.hp.value} onChange={e => handleInputChange(e)}></input>\n                  {form.hp.error && \n                    <div className=\"card-panel red accent-1\">\n                      {form.hp.error}\n                    </div>\n                  }\n                </div>\n                {/* Pokemon cp */}\n                <div className=\"form-group\">\n                  <label htmlFor=\"cp\">Dégâts</label>\n                  <input id=\"cp\" name=\"cp\" type=\"number\" className=\"form-control\" value={form.cp.value} onChange={e => handleInputChange(e)}></input>\n                  {form.cp.error && \n                    <div className=\"card-panel red accent-1\">\n                      {form.cp.error}\n                    </div>\n                  }\n                </div>\n                {/* Pokemon types */}\n                <div className=\"form-group\">\n                  <label>Types</label>\n                  {types.map(type => (\n                    <div key={type} style={{marginBottom: '10px'}}>\n                      <label>\n                        <input id={type} type=\"checkbox\" className=\"filled-in\" value={type} disabled={!isTypesValid(type)} checked={hasType(type)} onChange={e => selectType(type, e)}></input>\n                        <span>\n                          <p className={formatType(type)}>{ type }</p>\n                        </span>\n                      </label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n              <div className=\"card-action center\">\n                {/* Submit button */}\n                <button type=\"submit\" className=\"btn\">Valider</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>\n  );\n};\n   \nexport default PokemonForm;"]},"metadata":{},"sourceType":"module"}